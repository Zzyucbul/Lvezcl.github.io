<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('新增')"/>
</head>
<body>
<form class="layui-form">
    <div class="mainBox">
        <div class="main-container">
            <div class="main-container">
											
							<div class="layui-form-item">
			                    <label class="layui-form-label">学生姓名</label>
			                    <div class="layui-input-block">
			                        <input type="text" lay-verify="studentName" name="studentName" autocomplete="off" placeholder="请输入学生姓名" class="layui-input">
			                    </div>
			                </div>
							<div class="layui-form-item">
			                    <label class="layui-form-label">入学年份</label>
			                    <div class="layui-input-block">
			                        <input type="text" lay-verify="admissionTime" name="admissionTime" autocomplete="off" placeholder="请输入4位入学年份" class="layui-input">
			                    </div>
			                </div>
			                <div class="layui-form-item">
							    <label class="layui-form-label">性别</label>
							    <div class="layui-input-inline">
							      <input type="radio" name="sex" value="1" title="男" checked>
							      <input type="radio" name="sex" value="0" title="女">
							    </div>
							</div>
			                <div class="layui-form-item">
						    	<label class="layui-form-label">院系</label>
						    	<div class="layui-input-inline">
						        	<select name="departId" lay-verify="departId" lay-search>
								    	<option th:each="depart : ${departList}"  th:text="${depart.departName}" th:value="${depart.departId}"></option>
						      		</select>
						    	</div>
						  	</div>
						  	
						  	<div class="layui-form-item">
						    	<label class="layui-form-label">专业</label>
						    	<div class="layui-input-inline">
						        	<select name="majorId" lay-verify="majorId" lay-search>
								    	<option th:each="major : ${majorList}"  th:text="${major.majorName}" th:value="${major.majorId}"></option>
						      		</select>
						    	</div>
						  	</div>
						  	
						  	<div class="layui-form-item">
						    	<label class="layui-form-label">班级名称</label>
						    	<div class="layui-input-inline">
						        	<select name="majorId" lay-verify="majorId" lay-search>
								    	<option th:each="major : ${majorList}"  th:text="${major.majorName}" th:value="${major.majorId}"></option>
						      		</select>
						    	</div>
						  	</div>
						  	
						  	<div class="layui-form-item">
						    	<label class="layui-form-label">班级编号</label>
						    	<div class="layui-input-inline">
						        	<select name="classNum" lay-verify="classNum" lay-search>
								    	<option value="1">1</option>
								    	<option value="2">2</option>
								    	<option value="3">3</option>
								    	<option value="4">4</option>
								    	<option value="5">5</option>
								    	<option value="6">6</option>
								    	<option value="7">7</option>
								    	<option value="8">8</option>
								    	<option value="9">9</option>
								    	<option value="10">10</option>
								    	<option value="11">11</option>
								    	<option value="12">12</option>
								    	<option value="13">13</option>
								    	<option value="14">14</option>
								    	<option value="15">15</option>
								    	<option value="16">16</option>
								    	<option value="17">17</option>
								    	<option value="18">18</option>
								    	<option value="19">19</option>
								    	<option value="20">20</option>
								    	
								    	
						      		</select>
						    	</div>
						  	</div>		
											
							<div class="layui-form-item">
			                    <label class="layui-form-label">身份证号</label>
			                    <div class="layui-input-block">
			                        <input type="text" name="studentIdcard" lay-verify="studentIdcard" autocomplete="off" placeholder="请输入18位身份证号" class="layui-input">
			                    </div>
			                </div>
									
											
						
							    <div class="layui-form-item">
								    <label class="layui-form-label">选择框</label>
								    <div class="layui-input-inline">
								      <select name="ethnic" lay-verify="ethnic" lay-search>
						
											<option value="汉族">汉族</option>
											<option value="蒙古族">蒙古族</option>
											<option value="回族">回族</option>
											<option value="藏族">藏族</option>
											<option value="维吾尔族">维吾尔族</option>
											<option value="苗族">苗族</option>
											<option value="彝族">彝族</option>
											<option value="壮族">壮族</option>
											<option value="布依族">布依族</option>
											<option value="朝鲜族">朝鲜族</option>
											<option value="满族">满族</option>
											<option value="侗族">侗族</option>
											<option value="瑶族">瑶族</option>
											<option value="白族">白族</option>
											<option value="土家族">土家族</option>
											<option value="哈尼族">哈尼族</option>
											<option value="哈萨克族">哈萨克族</option>
											<option value="傣族">傣族</option>
											<option value="黎族">黎族</option>
											<option value="傈僳族">傈僳族</option>
											<option value="佤族">佤族</option>
											<option value="畲族">畲族</option>
											<option value="高山族">高山族</option>
											<option value="拉祜族">拉祜族</option>
											<option value="水族">水族</option>
											<option value="东乡族">东乡族</option>
											<option value="纳西族">纳西族</option>
											<option value="景颇族">景颇族</option>
											<option value="柯尔克孜族">柯尔克孜族</option>
											<option value="土族">土族</option>
											<option value="达斡尔族">达斡尔族</option>
											<option value="仫佬族">仫佬族</option>
											<option value="羌族">羌族</option>
											<option value="布朗族">布朗族</option>
											<option value="撒拉族">撒拉族</option>
											<option value="毛南族">毛南族</option>
											<option value="仡佬族">仡佬族</option>
											<option value="锡伯族">锡伯族</option>
											<option value="阿昌族">阿昌族</option>
											<option value="普米族">普米族</option>
											<option value="塔吉克族">塔吉克族</option>
											<option value="怒族">怒族</option>
											<option value="乌孜别克族">乌孜别克族</option>
											<option value="俄罗斯族">俄罗斯族</option>
											<option value="鄂温克族">鄂温克族</option>
											<option value="德昂族">德昂族</option>
											<option value="保安族">保安族</option>
											<option value="裕固族">裕固族</option>
											<option value="京族">京族</option>
											<option value="塔塔尔族">塔塔尔族</option>
											<option value="独龙族">独龙族</option>
											<option value="鄂伦春族">鄂伦春族</option>
											<option value="赫哲族">赫哲族</option>
											<option value="门巴族">门巴族</option>
											<option value="珞巴族">珞巴族</option>
											<option value="基诺族">基诺族</option>
		
								      </select>
								    </div>
								  </div>
							

									
											
							<div class="layui-form-item">
			                    <label class="layui-form-label">籍贯</label>
			                    <div class="layui-input-block">
			                        <input type="text" name="origin" lay-verify="origin" autocomplete="off" placeholder="请输入籍贯" class="layui-input">
			                    </div>
			                </div>
									
											
							<div class="layui-form-item">
			                    <label class="layui-form-label">家庭住址</label>
			                    <div class="layui-input-block">
			                        <input type="text" name="address" lay-verify="address" autocomplete="off" placeholder="请输入家庭住址" class="layui-input">
			                    </div>
			                </div>
									
											
							<div class="layui-form-item">
			                    <label class="layui-form-label">毕业学校</label>
			                    <div class="layui-input-block">
			                        <input type="text" name="graduateName"  lay-verify="graduateName" autocomplete="off" placeholder="请输入毕业学校" class="layui-input">
			                    </div>
			                </div>
							
									
							<div class="layui-form-item">
			                    <label class="layui-form-label">政治面貌</label>
			                   <div class="layui-input-inline">
			                   <select name="political" lay-verify="political" lay-search>
							        <option value="群众">群众</option>
							        <option value="中共预备党员员">中共预备党员</option>
							        <option value="中共党员">中共党员</option>
							        <option value="共青团员">共青团员</option>
							        
							    </select>
							     </div>
			                </div>
									
											
							<div class="layui-form-item">
			                    <label class="layui-form-label">手机号</label>
			                    <div class="layui-input-block">
			                        <input type="text" name="phoneNumber" lay-verify="phoneNumber" autocomplete="off" placeholder="请输入11位的手机号" class="layui-input">
			                    </div>
			                </div>
            </div>
        </div>
    </div>
    <div class="bottom">
        <div class="button-container">
            <button type="submit" class="layui-btn layui-btn-normal layui-btn-sm" lay-submit="" lay-filter="student-save">
                <i class="layui-icon layui-icon-ok"></i>
                提交
            </button>
            <button type="reset" class="layui-btn layui-btn-primary layui-btn-sm">
                <i class="layui-icon layui-icon-refresh"></i>
                重置
            </button>
        </div>
    </div>
</form>
<th:block th:include="include :: footer"/>
<script>
	//如果用数字代表某个政治面貌，判断是省力，但映射时依然需要一张表，所以通过map
	//映射中和
	const t_political = new Set();
	t_political.add("群众");
	t_political.add("中共预备党员");
	t_political.add("中共党员");
	t_political.add("共青团员");
	
    layui.use(['form','laydate','jquery'], function () {
        let form = layui.form;
        let $ = layui.jquery;
       let MODULE_PATH = rootPath+"/StudentController";
     //验证表单
    	form.verify({
    		studentName : function (value, item) {
    			if (value.match(stun) == null){
    				return "学生名称应为2到18位汉字";
    			}
    			
    		},
    		admissionTime : function (value, item) {
    			if (value.match(year) == null){
    				return "入学年份应为4位数字";
    			}
    			
    		},
    		studentIdcard : function (value, item) {
    			if (value.match(stuic) == null){
    				return "学生身份证应为18位数字";
    			}
    			
    		},
    		origin : function (value, item) {
    			if (value.match(stuori) == null){
    				return "籍贯应为最大长度为50位的汉字";
    			}
    			
    		},
    		address : function (value, item) {
    			if (value.match(stuadd) == null){
    				return "家庭住址应为最大长度为80位由汉字、数字、字母的组合";
    			}
    			
    		},
    		
    		graduateName : function (value, item) {
    			if (value.match(stugra) == null){
    				return "毕业学校应为最大长度为20位的毕业高中名称";
    			}
    			
    		},
    		origin : function (value, item) {
    			if (value.match(stuori) == null){
    				return "籍贯应为最大长度为50位的汉字";
    			}
    			
    		},
    		address : function (value, item) {
    			if (value.match(stuadd) == null){
    				return "家庭住址应为最大长度为80位由汉字、数字、字母的组合";
    			}
    			
    		},
    		phoneNumber : function (value, item) {
    			if (value.match(pn) == null){
    				return "手机号应为11位的数字";
    			}
    			
    		},
    		phoneNumber : function (value, item) {
    			if (value.match(pn) == null){
    				return "手机号应为11位的数字";
    			}
    			
    		},
    		political:function (value, item) {
    			if (!t_political.has(value)){
    				return "请选择政治面貌";
    			}
    			
    		},
    		
   	});
		
		
        //保存
        form.on('submit(student-save)', function (data) {
			console.log(data.field);
			
			
			data.field.admissionTime = data.field.admissionTime +'-11-1 11:0:0'
			
        	let loader = layer.load();
            $.ajax({
                url: MODULE_PATH+'/add',
                data: data.field,
                dataType: 'json',
                contentType: 'application/x-www-form-urlencoded',
                type: 'post',
                success: function (result) {
                    if (result.code==200) {
                        layer.msg(result.msg, {icon: 1, time: 1000}, function () {
                            parent.layer.close(parent.layer.getFrameIndex(window.name));//关闭当前页
                            parent.layui.table.reload("student-table");
                            layer.close(loader);
                        });
                    } else {
                        layer.msg(result.msg, {icon: 2, time: 1000});
                        layer.close(loader);
                    }
                }
            })
            return false;
        });
    });
    
    //匹配规则
    const stun = /^[\u4e00-\u9fa5]{2,18}$/g;
        const stuic = /^[1-9]\d{5}(19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/g;
		const stuori = /^[\u4e00-\u9fa5]{0,50}$/g;
		const stuadd = /^[\u4e00-\u9fa5\w\d\s]+$/g;
		const stugra = /^[\u4e00-\u9fa50-9]{0,20}$/g;
		const pn = /^[0-9]{11}$/g;
		const year = /^[0-9]/g;
	
	      

  
	
	
</script>
</body>
</html>